import{c as u,r as a,j as e,L as k}from"./index-DgxKoCgn.js";import{a as c}from"./axios-dF6Nnch2.js";import"./index-Dq7h7Pqt.js";/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],T=u("bell",R);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],D=u("circle-alert",A);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],_=u("refresh-cw",M);function P(){const[s,o]=a.useState({name:"",earnings:0,tasksCompleted:0,referrals:0,points:0}),[l,n]=a.useState([]),[r,d]=a.useState([]),[h,p]=a.useState([]),[z,f]=a.useState(!0),[b,g]=a.useState(null),[y,S]=a.useState(!1),j=async()=>{f(!0),g(null);try{const t=localStorage.getItem("token"),m=localStorage.getItem("userId"),[i,I,L]=await Promise.all([c.get(`/api/user/${m}`,{headers:{Authorization:`Bearer ${t}`}}),c.get("/api/surveys/top").catch(()=>({data:[]})),c.get("/api/offerwall/top").catch(()=>({data:[]}))]);o({name:i.data?.name||"User",earnings:i.data?.balance||0,tasksCompleted:i.data?.tasksCompleted||0,referrals:i.data?.referrals||0,points:i.data?.points||0}),n(I.data||[]),d(L.data||[])}catch(t){console.error("Dashboard fetch error:",t),g("Could not load dashboard data.")}finally{f(!1)}},$=async()=>{try{const t=localStorage.getItem("token"),m=await c.get("/api/notifications",{headers:{Authorization:`Bearer ${t}`}});p(m.data)}catch(t){console.error("Notifications fetch error:",t),p([])}};a.useEffect(()=>{j(),$()},[]);const C=h.filter(t=>!t.read).length,E=(s.points/100).toFixed(2);return e.jsxs("div",{className:"max-w-md mx-auto space-y-6 pb-16",children:[b&&e.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-lg p-3 flex items-start",children:[e.jsx(D,{className:"h-5 w-5 text-red-500 mr-2 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-red-500 text-sm",children:b}),e.jsxs("button",{onClick:j,className:"text-red-500 hover:text-red-400 text-xs underline flex items-center mt-1",children:[e.jsx(_,{className:"h-3 w-3 mr-1"}),"Retry"]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-white",children:["Welcome back, ",s.name," ðŸ‘‹"]}),e.jsx("p",{className:"text-gray-400",children:"Letâ€™s earn more today!"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>S(!y),className:"text-white relative p-1 hover:bg-gray-800 rounded-full transition-colors",children:[e.jsx(T,{size:22}),C>0&&e.jsx("span",{className:"absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500"})]}),y&&e.jsx("div",{className:"absolute right-0 mt-2 w-72 bg-[#140932] border border-gray-700 rounded-lg shadow-lg z-10",children:h.length===0?e.jsx("p",{className:"p-3 text-gray-500",children:"No notifications"}):h.map(t=>e.jsx("div",{className:"p-3 text-sm text-white border-b border-gray-700",children:t.message},t.id))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(x,{label:"Earnings",value:`$${s.earnings.toFixed(2)}`,color:"blue"}),e.jsx(x,{label:"Tasks Completed",value:s.tasksCompleted,color:"green"}),e.jsx(x,{label:"Points",value:`${s.points} pts`,color:"yellow",sub:`(~$${E})`}),e.jsx(x,{label:"Referrals",value:s.referrals,color:"purple",link:{to:"/dashboard/referral",text:"View referral details â†’"}})]}),e.jsx(v,{title:"ðŸ”¥ Top Surveys",children:l.length>0?l.map(t=>e.jsx(N,{title:t.title,reward:`$${t.reward}`,link:`/dashboard/survey/${t.id}`,linkText:"Start Survey â†’",color:"blue"},t.id)):e.jsx(w,{text:"No surveys available"})}),e.jsx(v,{title:"ðŸ’Ž Top Offers",children:r.length>0?r.map(t=>e.jsx(N,{title:t.title,reward:`$${t.reward}`,link:`/dashboard/offers/${t.id}`,linkText:"View Offer â†’",color:"green"},t.id)):e.jsx(w,{text:"No offers available"})})]})}function x({label:s,value:o,color:l,sub:n,link:r}){const d={blue:"border-blue-500 text-blue-700",green:"border-green-500 text-green-700",yellow:"border-yellow-500 text-yellow-600",purple:"border-purple-500 text-purple-700"};return e.jsxs("div",{className:`bg-white rounded-lg shadow p-4 text-center border-t-4 ${d[l]}`,children:[e.jsx("h2",{className:"text-sm text-gray-500",children:s}),e.jsx("p",{className:"text-xl font-bold",children:o}),n&&e.jsx("p",{className:"text-sm text-gray-600",children:n}),r&&e.jsx(k,{to:r.to,className:"text-sm text-blue-600 hover:underline mt-1 block",children:r.text})]})}function v({title:s,children:o}){return e.jsxs("div",{className:"space-y-3",children:[e.jsx("h3",{className:"text-lg font-bold text-white",children:s}),o]})}function N({title:s,reward:o,link:l,linkText:n,color:r}){const d={blue:"text-blue-600",green:"text-green-600"};return e.jsxs("div",{className:"bg-white border rounded-lg p-3 shadow",children:[e.jsx("h4",{className:"font-semibold text-sm mb-1",children:s}),e.jsx("p",{className:`${d[r]} text-sm font-bold`,children:o}),e.jsx(k,{to:l,className:`text-sm ${d[r]} hover:underline`,children:n})]})}function w({text:s}){return e.jsx("div",{className:"bg-gray-800/20 border border-gray-700 rounded-lg p-4 text-center",children:e.jsx("p",{className:"text-gray-400",children:s})})}export{P as default};
