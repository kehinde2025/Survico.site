import{u as b,r as m,j as e,z as t}from"./index-BnNZ3P73.js";import{s as w,a as y,p as v}from"./firebase-BYkQpCoV.js";import{a as h}from"./index-Dq7h7Pqt.js";function C(){const c=b(),[s,u]=m.useState({fullName:"",email:"",phoneNumber:"",password:"",referrerId:""}),[r,g]=m.useState({}),[p,i]=m.useState("");m.useEffect(()=>{const a=new URLSearchParams(window.location.search).get("ref");a&&u(n=>({...n,referrerId:a}))},[]);const d=a=>{u({...s,[a.target.name]:a.target.value})},x=()=>{const a={};return s.fullName.trim()||(a.fullName="Full name is required"),s.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)||(a.email="Invalid email"),s.phoneNumber.match(/^[0-9]{10,15}$/)||(a.phoneNumber="Invalid phone"),s.password.length<6&&(a.password="Password must be at least 6 characters"),g(a),Object.keys(a).length===0},f=async a=>{if(a.preventDefault(),i(""),!x())return;const n=t.loading("Creating your account...");try{const o=await h.post(`https://survico-backend.up.railway.app/api/surveys?userId=${userId}`,{name:s.fullName,email:s.email,password:s.password,phone:s.phoneNumber,referrerId:s.referrerId||null});t.dismiss(n),t.success("ðŸŽ‰ Registration successful! Welcome to Survico."),localStorage.setItem("token",o.data.token),localStorage.setItem("user",JSON.stringify(o.data.user)),c("/onboarding")}catch(o){t.dismiss(n);const l=o.response?.data?.message||"Server error";i(l),t.error(l)}},N=async()=>{i("");const a=t.loading("Signing in with Google...");try{const o=(await w(y,v)).user,l=await h.post("https://survico-backend.up.railway.app/api/auth/google",{name:o.displayName,email:o.email});t.dismiss(a),t.success("âœ… Google Sign-In successful!"),localStorage.setItem("token",l.data.token),localStorage.setItem("user",JSON.stringify(l.data.user)),c("/onboarding")}catch{t.dismiss(a),i("Google Sign-In failed. Please try again."),t.error("Google Sign-In failed. Please try again.")}};return e.jsx("div",{className:"min-h-screen bg-[#140932] flex items-center justify-center px-4",children:e.jsxs("div",{className:"bg-[#685699] rounded-lg shadow-lg p-8 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:"Create Your Survico Account"}),p&&e.jsx("p",{className:"text-sm text-red-500 mb-2 text-center",children:p}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"fullName",placeholder:"Full Name",value:s.fullName,onChange:d,className:`w-full px-4 py-2 border rounded ${r.fullName?"border-red-500":""}`}),r.fullName&&e.jsx("p",{className:"text-sm text-red-500",children:r.fullName}),e.jsx("input",{type:"email",name:"email",placeholder:"Email address",value:s.email,onChange:d,className:`w-full px-4 py-2 border rounded ${r.email?"border-red-500":""}`}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email}),e.jsx("input",{type:"tel",name:"phoneNumber",placeholder:"Phone Number",value:s.phoneNumber,onChange:d,className:`w-full px-4 py-2 border rounded ${r.phoneNumber?"border-red-500":""}`}),r.phoneNumber&&e.jsx("p",{className:"text-sm text-red-500",children:r.phoneNumber}),e.jsx("input",{type:"password",name:"password",placeholder:"Create a password",value:s.password,onChange:d,className:`w-full px-4 py-2 border rounded ${r.password?"border-red-500":""}`}),r.password&&e.jsx("p",{className:"text-sm text-red-500",children:r.password}),e.jsx("button",{type:"submit",className:"w-full bg-blue-700 text-white py-2 rounded hover:bg-blue-800 transition",children:"Sign Up"})]}),e.jsx("p",{className:"text-sm text-white text-center pt-5",children:"Or"}),e.jsx("button",{type:"button",onClick:N,className:"w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 mt-4",children:"Sign Up with Google"}),e.jsxs("p",{className:"text-sm text-center mt-4",children:["Already have an account?"," ",e.jsx("a",{href:"/login",className:"text-white hover:underline",children:"Log In"})]})]})})}export{C as default};
