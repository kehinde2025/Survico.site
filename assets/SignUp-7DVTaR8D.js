import{u as f,r as n,j as e}from"./index-DgxKoCgn.js";import{s as N,a as b,p as w}from"./firebase-BYkQpCoV.js";import{a as u}from"./index-Dq7h7Pqt.js";function S(){const m=f(),[a,d]=n.useState({fullName:"",email:"",phoneNumber:"",password:"",referrerId:""}),[t,p]=n.useState({}),[c,o]=n.useState("");n.useEffect(()=>{const r=new URLSearchParams(window.location.search).get("ref");r&&d(s=>({...s,referrerId:r}))},[]);const l=r=>{d({...a,[r.target.name]:r.target.value})},h=()=>{const r={};return a.fullName.trim()||(r.fullName="Full name is required"),a.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)||(r.email="Invalid email"),a.phoneNumber.match(/^[0-9]{10,15}$/)||(r.phoneNumber="Invalid phone"),a.password.length<6&&(r.password="Password must be at least 6 characters"),p(r),Object.keys(r).length===0},x=async r=>{if(r.preventDefault(),o(""),!!h())try{const s=await u.post("http://localhost:5000/api/auth/register",{name:a.fullName,email:a.email,password:a.password,phone:a.phoneNumber,referrerId:a.referrerId||null});console.log("✅ Registration success:",s.data),localStorage.setItem("token",s.data.token),localStorage.setItem("user",JSON.stringify(s.data.user)),m("/onboarding")}catch(s){console.error(s),o(s.response?.data?.message||"Server error")}},g=async()=>{o("");try{const s=(await N(b,w)).user;console.log("✅ Google Firebase User:",s);const i=await u.post("http://localhost:5000/api/auth/google",{name:s.displayName,email:s.email});console.log("✅ Google backend success:",i.data),localStorage.setItem("token",i.data.token),localStorage.setItem("user",JSON.stringify(i.data.user)),m("/onboarding")}catch(r){console.error("❌ Google Sign-In error:",r),o("Google Sign-In failed. Please try again.")}};return e.jsx("div",{className:"min-h-screen bg-[#140932] flex items-center justify-center px-4",children:e.jsxs("div",{className:"bg-[#685699] rounded-lg shadow-lg p-8 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:"Create Your Survico Account"}),c&&e.jsx("p",{className:"text-sm text-red-500 mb-2 text-center",children:c}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsx("input",{type:"text",name:"fullName",placeholder:"Full Name",value:a.fullName,onChange:l,className:`w-full px-4 py-2 border rounded ${t.fullName?"border-red-500":""}`}),t.fullName&&e.jsx("p",{className:"text-sm text-red-500",children:t.fullName}),e.jsx("input",{type:"email",name:"email",placeholder:"Email address",value:a.email,onChange:l,className:`w-full px-4 py-2 border rounded ${t.email?"border-red-500":""}`}),t.email&&e.jsx("p",{className:"text-sm text-red-500",children:t.email}),e.jsx("input",{type:"tel",name:"phoneNumber",placeholder:"Phone Number",value:a.phoneNumber,onChange:l,className:`w-full px-4 py-2 border rounded ${t.phoneNumber?"border-red-500":""}`}),t.phoneNumber&&e.jsx("p",{className:"text-sm text-red-500",children:t.phoneNumber}),e.jsx("input",{type:"password",name:"password",placeholder:"Create a password",value:a.password,onChange:l,className:`w-full px-4 py-2 border rounded ${t.password?"border-red-500":""}`}),t.password&&e.jsx("p",{className:"text-sm text-red-500",children:t.password}),e.jsx("button",{type:"submit",className:"w-full bg-blue-700 text-white py-2 rounded hover:bg-blue-800 transition",children:"Sign Up"})]}),e.jsx("p",{className:"text-sm text-white text-center pt-5",children:"Or"}),e.jsx("button",{type:"button",onClick:g,className:"w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 mt-4",children:"Sign Up with Google"}),e.jsxs("p",{className:"text-sm text-center mt-4",children:["Already have an account?"," ",e.jsx("a",{href:"/login",className:"text-white hover:underline",children:"Log In"})]})]})})}export{S as default};
