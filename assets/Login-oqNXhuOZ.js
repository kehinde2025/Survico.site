import{u as j,r as c,j as e}from"./index-DgxKoCgn.js";import{s as y,a as N,p as v}from"./firebase-BYkQpCoV.js";import{a as u}from"./index-Dq7h7Pqt.js";function k(){const o=j(),[s,h]=c.useState({email:"",password:""}),[r,g]=c.useState({}),[m,i]=c.useState(""),p=t=>{h({...s,[t.target.name]:t.target.value})},x=()=>{const t={};return s.email.match(/^[^\s@]+@[^\s@]+\.[^\s@]+$/)||(t.email="Enter a valid email"),(!s.password||s.password.length<6)&&(t.password="Password must be at least 6 characters"),g(t),Object.keys(t).length===0},b=async t=>{if(t.preventDefault(),i(""),!!x())try{const a=await u.post("http://localhost:5000/api/auth/login",{email:s.email,password:s.password}),{user:n,token:l}=a.data;if(localStorage.setItem("token",l),localStorage.setItem("user",JSON.stringify(n)),n.role==="admin")o("/admin/dashboard");else if(n.role==="spectator")o("/spectator/dashboard");else{const d=n.profileCompleted;o(d?"/dashboard":"/onboarding")}}catch(a){console.error(a),i(a.response?.data?.message||"Invalid login.")}},f=async()=>{try{const a=(await y(N,v)).user,n=await u.post("http://localhost:5000/api/auth/google",{name:a.displayName,email:a.email}),{user:l,token:d}=n.data;if(localStorage.setItem("token",d),localStorage.setItem("user",JSON.stringify(l)),l.role==="admin")o("/admin/dashboard");else if(l.role==="spectator")o("/spectator/dashboard");else{const w=l.profileCompleted;o(w?"/dashboard":"/onboarding")}}catch(t){console.error(t),i("Google login failed.")}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#140932] px-4",children:e.jsxs("div",{className:"bg-[#685699] rounded-lg shadow-lg p-8 w-full max-w-md",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-6 text-center",children:"Log In to Survico"}),m&&e.jsx("p",{className:"text-sm text-red-500 mb-2 text-center",children:m}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsx("input",{type:"email",name:"email",placeholder:"Email address",value:s.email,onChange:p,className:`w-full px-4 py-2 border rounded focus:outline-none ${r.email?"border-red-500":""}`}),r.email&&e.jsx("p",{className:"text-sm text-red-500",children:r.email}),e.jsx("input",{type:"password",name:"password",placeholder:"Password",value:s.password,onChange:p,className:`w-full px-4 py-2 border rounded focus:outline-none ${r.password?"border-red-500":""}`}),r.password&&e.jsx("p",{className:"text-sm text-red-500",children:r.password}),e.jsx("button",{type:"submit",className:"w-full bg-blue-700 text-white py-2 rounded hover:bg-blue-800",children:"Log In"})]}),e.jsx("p",{className:"text-sm text-white text-center pt-5",children:"Or"}),e.jsx("button",{type:"button",onClick:f,className:"w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 mt-4",children:"Log In with Google"}),e.jsxs("p",{className:"text-sm text-center mt-4",children:["Donâ€™t have an account?"," ",e.jsx("a",{href:"/signup",className:"text-white hover:underline",children:"Sign Up"})]})]})})}export{k as default};
